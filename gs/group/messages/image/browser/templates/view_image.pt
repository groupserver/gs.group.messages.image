<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  metal:use-macro="context/@@groupserver_site_home_layout/page">
  <head>
    <title metal:fill-slot="title">
      <span tal:replace="view/filename"/> by
      <span tal:replace="view/metadata/authorInfo/name"/>:
      <span tal:replace="view/metadata/topic/subject"/>:
      <span tal:replace="view/groupInfo/name"/>:
      <span tal:replace="view/siteInfo/name"/>
    </title>
    <tal:block metal:fill-slot="metadata">
      <link rel="prev" 
        tal:condition="view/metadata/prevURI"
        tal:attributes="href view/metadata/prevURI"/>
      <link rel="up"
        tal:attributes="href view/metadata/postURI" />
      <link rel="next"
        tal:condition="view/metadata/nextURI"
        tal:attributes="href view/metadata/nextURI"/>
    </tal:block>
  </head>
  <body>
    <div metal:fill-slot="body" class="image">
      <h1><code tal:content="view/filename">filename</code></h1>
      
      <ul id="navigation" class="inline-list navlinks">
        <li class="prevlink">
          <a tal:condition="view/metadata/prevURI" class="prev"
            tal:attributes="href view/metadata/prevURI"
            href="#"><img src="#" 
                tal:attributes="src view/metadata/prevImage/icon_uri"/> 
            Previous Image</a>
          <span tal:condition="not:view/metadata/prevURI" 
            class="prev">Previous Image</span>
        </li>
        <li class="postLink">
          <a href="#" class="up"
            tal:attributes="href view/metadata/postURI">Post in
            <span tal:replace="view/metadata/topic/subject">A Topic</span></a>
        </li>
        <li class="nextlink">
          <a tal:condition="view/metadata/nextURI" class="next"
            tal:attributes="href view/metadata/nextURI"
            href="#">Next Image
            <img src="#" 
              tal:attributes="src view/metadata/nextImage/icon_uri"/></a>
          <span tal:condition="not:view/metadata/nextURI" 
            class="next">Next Image</span>
        </li>
      </ul>
      <div class="share-bar" 
        tal:attributes="title view/filename;
         public python:view.isPublic and 1 or 0;
         href string:${view/siteInfo/url}/r/img/${view/imageId}">
         &#160;
      </div><!--share-bar-->
      <div class="metadata"
        tal:define="munge_date python:modules['Products.XWFCore.XWFUtils'].munge_date;
          t view/metadata/mime;">
        <div tal:define="user view/metadata/authorInfo/user"
          tal:replace="structure provider:groupserver.UserImage" />
        <div id="from"><strong>From:</strong>
          <a href="#" class="fn"
            tal:attributes="href view/metadata/authorInfo/url"
            tal:content="view/metadata/authorInfo/name">An Author</a></div>
        <div id="filename">
          <strong>Name:</strong>
          <acronym href="#"
            tal:define="icon python:t.replace('/','-').replace('.','-').strip()"
            tal:attributes="class string:fileIcon ${icon};
              title t;">&#160;</acronym>
          <code class="fileName" 
            tal:content="view/filename">file.name</code>
        </div>
        <div id="topic"><strong>Topic:</strong>
          <a href="#" class="topic"
            tal:attributes="href string:/r/topic/${view/metadata/topic/last_post_id}"
            tal:content="view/metadata/topic/subject">A Topic</a></div>
        <div id="group"><strong>Group:</strong>
          <a href="#" class="group"
            tal:attributes="href view/groupInfo/url"
            tal:content="view/groupInfo/name">A Group</a>
        </div>
        <div id="date">
          <strong>Date:</strong>
          <span class="date"
            tal:content="python:munge_date(view.context, view.metadata.date)">A Date</span>
        </div>
      </div><!--metadata-->
      <div id="scaled-image">
        <a href="#" title="Full sized image"
          tal:define="s view/metadata/imageMetadata/file_size;
            skb python:u'%1.2fKB' % (s/1024.0);"
          tal:attributes="href view/fullImageURI;
            title string:Full sized image: ${view/fullImage/width} by ${view/fullImage/height} pixels (${skb})"><img src="#" 
          class="scaledImage" 
          tal:attributes="src view/scaledImageURI"/></a>
      </div>
      <div id="alternate-sizes">
        <p>
          <a href="#"
            tal:attributes="href view/fullImageURI">Full sized image:</a>
          <span tal:content="view/fullImage/width">width</span> by
          <span tal:content="view/fullImage/height">height</span> pixels
          (<span class="size"
            tal:define="s view/metadata/imageMetadata/file_size"
            tal:content="python:u'%1.2fKB' % (s/1024.0)"/>)
        </p>
      </div><!--alternate-sizes-->
    </div>
    <tal:block metal:fill-slot="javascript">
      <script type="text/javascript"
        src="/++resource++sharebox-20100721.js">&#160;</script>
    </tal:block>
  </body>
</html>

